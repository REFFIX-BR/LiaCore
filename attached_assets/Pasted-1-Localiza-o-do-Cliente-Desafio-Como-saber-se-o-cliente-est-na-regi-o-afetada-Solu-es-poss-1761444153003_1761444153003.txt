1. Localiza√ß√£o do Cliente
Desafio: Como saber se o cliente est√° na regi√£o afetada?

Solu√ß√µes poss√≠veis:

Op√ß√£o A (Ideal): Integra√ß√£o com CRM/sistema de gest√£o do ISP via API
(obs. Ja temos o cpf do assinante no banco de dados e so teremos que fazer a consulta via api para ver se o cliente esta na area afetada:

Get para o Endpint: 

https://webhook.trtelecom.net/webhook/consultar/cliente/infoscontrato

passar o valor "documento" como query par√¢meter para retornar os dados¬†do¬†cliente.
Reposnse: 


[
  {
    "COD_CLIENTE": "1.12289",
    "nomeCliente": "LUCAS DA SILVA NASCIMENTO",
    "CPF": "172.138.537-16",
    "EMAIL1": "kyulucas23@gmail.com",
    "TELEFONE_RESIDENCIAL": "",
    "TELEFONE_CELULAR1": "(24) 9923-78219",
    "TELEFONE_CELULAR2": "(24) 9881-59559",
    "plano": "TR FIBER 650 MEGA",
    "velocidadeContratada": "665600",
    "LOGIN": "20222925",
    "senha_pppoe": "992378219",
    "CEP": "25804-250",
    "ENDERECO": "ISALTINO SILVEIRA",
    "BAIRRO": "CANTAGALO",
    "CIDADE": "TRES RIOS",
    "COMPLEMENTO": "333,¬†CASA¬†2"
¬†¬†}
)

2. Granularidade das Regi√µes
O sistema precisa de uma estrutura hier√°rquica:

Estado ‚Üí Cidade ‚Üí Bairro ‚Üí Rua (opcional)
3. Controle de Reenvio
Cliente j√° notificado n√£o deve receber a mesma mensagem m√∫ltiplas vezes
Precisa rastrear quem foi notificado para envio da resolu√ß√£o
4. Mensagens Proativas
A Evolution API precisa permitir envio de mensagens proativas (n√£o apenas respostas)
Verificar se h√° limita√ß√µes/custos adicionais
üí° Sugest√µes de Melhorias
1. Adicionar Previs√£o de Normaliza√ß√£o
{
  estimatedResolution: DateTime, // "Previs√£o: 2 horas"
  autoResolve: boolean, // Resolver automaticamente ap√≥s o hor√°rio
}
2. Templates de Mensagens
Criar templates pr√©-configurados para acelerar o cadastro:

"Instabilidade T√©cnica"
"Manuten√ß√£o Programada"
"Queda de Energia"
"Problema na Regi√£o"
3. N√≠veis de Severidade
enum FailureSeverity {
  LOW,      // Lentid√£o
  MEDIUM,   // Instabilidade
  HIGH,     // Sem servi√ßo
  CRITICAL  // Emerg√™ncia
}
4. Dashboard em Tempo Real
Adicionar m√©tricas:

Quantidade de clientes notificados
Quantidade de tentativas de contato bloqueadas
Tempo m√©dio de resolu√ß√£o
Regi√µes mais afetadas
5. Integra√ß√£o com Monitor
Mostrar um badge/alerta no Monitor de Atendimento quando h√° falha ativa:

üö® ATEN√á√ÉO: Falha Massiva ativa em Centro, Bairro Sul (120 clientes afetados)
üóÇÔ∏è Modelo de Dados Proposto (Adaptado)
// Schema adaptado ao LIA CORTEX atual
// Tabela principal de falhas
massiveFailures {
  id: varchar (UUID)
  name: text
  status: text // 'scheduled' | 'active' | 'resolved' | 'cancelled'
  severity: text // 'low' | 'medium' | 'high' | 'critical'
  
  notificationMessage: text
  resolutionMessage: text (nullable)
  
  affectedRegions: json // {state, city, neighborhoods[]}
  estimatedResolution: timestamp (nullable)
  
  startTime: timestamp
  endTime: timestamp (nullable)
  
  createdBy: varchar (ref users)
  createdAt: timestamp
  updatedAt: timestamp
}
// Registro de notifica√ß√µes enviadas
failureNotifications {
  id: varchar (UUID)
  failureId: varchar (ref massiveFailures)
  contactId: varchar (ref contacts)
  conversationId: varchar (ref conversations)
  
  notificationType: text // 'failure' | 'resolution'
  sentAt: timestamp
  wasRead: boolean
}
// Regi√µes do sistema (para controle)
regions {
  id: varchar (UUID)
  state: text
  city: text
  neighborhood: text
  createdAt: timestamp
}
// Adicionar √† tabela contacts existente
contacts {
  ...campos existentes...
  + regionId: varchar (nullable, ref regions)
}
üìä Estimativa de Complexidade
Complexidade: M√âDIA-ALTA

Tempo estimado: 3-5 dias de desenvolvimento completo

Divis√£o:

Backend (40%): Schema, API endpoints, l√≥gica de intercepta√ß√£o
Frontend (35%): Interface de gerenciamento, modais, tabelas
Integra√ß√£o (20%): L√≥gica no fluxo de mensagens, workers
Testes (5%): E2E, valida√ß√µes
üõ£Ô∏è Roadmap de Implementa√ß√£o Sugerido
Fase 1 - MVP (Core Essencial)

 Schema do banco de dados
 CRUD de falhas massivas
 Interface b√°sica (cadastro, listagem, ativa√ß√£o)
 L√≥gica de intercepta√ß√£o no fluxo de mensagens
 Notifica√ß√£o autom√°tica
Fase 2 - Aprimoramentos

 Sistema de regi√µes
 Vincula√ß√£o de contatos √†s regi√µes
 Mensagem de resolu√ß√£o proativa
 Templates de mensagens
Fase 3 - Avan√ßado

 Dashboard com m√©tricas
 Integra√ß√£o com CRM externo
 Agendamento de falhas
 Notifica√ß√µes no Monitor
ü§î Quest√µes para Decis√£o
Antes de implementar, precisamos definir:

Quem pode criar/gerenciar falhas?

Apenas ADMIN?
ADMIN + SUPERVISOR?
Como ser√° o sistema de regi√µes inicial?

Cadastro manual de regi√µes?
Import de planilha?
Integra√ß√£o com API de CEP?
Limite de falhas simult√¢neas?

Pode ter m√∫ltiplas falhas ativas ao mesmo tempo em regi√µes diferentes?
Comportamento quando cliente responde?

Ignora completamente durante a falha?
Permite que ele force atendimento humano?